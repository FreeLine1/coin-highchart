{"ast":null,"code":"var _jsxFileName = \"/Users/maxym/Udemy&other/coin-data/client/src/CoinData/CoinData.js\",\n    _s = $RefreshSig$();\n\nimport './CoinData.css';\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { Button } from 'react-bootstrap';\nimport { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport Highcharts from 'highcharts';\nimport HighchartsReact from 'highcharts-react-official';\nimport \"react-loader-spinner/dist/loader/css/react-spinner-loader.css\";\nimport Loader from \"react-loader-spinner\";\nimport useWebSocket from 'react-use-websocket';\nimport moment from 'moment';\nimport Chart from \"./Chart\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst CoinData = () => {\n  _s();\n\n  const [data, setData] = useState([]);\n  const [histPrice, setHistPrice] = useState([]);\n  const [currentCoin, setCurrentCoin] = useState();\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [wsMessage, setwsMessage] = useState([]);\n  const {\n    sendMessage,\n    lastMessage\n  } = useWebSocket('ws://ws.coinapi.io/v1/');\n  useEffect(() => {\n    axios.get('http://localhost:3008/getAssetId').then(response => {\n      setData(response.data);\n    });\n  }, []);\n  useEffect(() => {\n    if (lastMessage) {\n      setwsMessage(JSON.parse(lastMessage.data));\n      console.log(JSON.parse(lastMessage.data));\n    }\n  }, [lastMessage]);\n  let filteredHistData = histPrice.map(el => [+new Date(el.time_open), Math.round(el.rate_open)]);\n\n  const onSubscribeBtn = () => {\n    axios.get(`http://localhost:3008/historicalPrice?coin=${currentCoin}`).then(response => {\n      setHistPrice(response.data);\n    });\n    alert(currentCoin);\n    sendMessage(JSON.stringify({\n      \"type\": \"hello\",\n      \"apikey\": \"B7A9ED97-386F-423A-993C-A19DEEC6AB21\",\n      \"heartbeat\": false,\n      \"subscribe_data_type\": [\"trade\"],\n      \"subscribe_filter_symbol_id\": [`BITSTAMP_SPOT_${currentCoin}_USD$`]\n    }));\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"select-coin\",\n      children: [/*#__PURE__*/_jsxDEV(Dropdown, {\n        className: \"dropdown\",\n        onChange: e => {\n          setCurrentCoin(e.value);\n        },\n        options: data.map(el => el.asset_id),\n        placeholder: \"Select an option\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        className: \"subscribe-btn\",\n        onClick: onSubscribeBtn,\n        variant: \"primary\",\n        children: \"Subscribe\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 17\n      }, this), ' ']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Market data\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"market-data\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        width: \"100%\",\n        cellPadding: \"5\",\n        children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Symbol:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Price:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Time:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: currentCoin\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: \" $ \" + wsMessage.price\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: moment.unix(+new Date(wsMessage.time_coinapi) / 1000).format(\"MMM D, h:mm a\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"charting-data\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Charting data\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }, this), isLoaded === true ? /*#__PURE__*/_jsxDEV(Loader, {\n        type: \"TailSpin\",\n        color: \"#0080ff\",\n        height: 80,\n        width: 80\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 21\n      }, this) : Chart(currentCoin, filteredHistData)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 9\n  }, this);\n};\n\n_s(CoinData, \"v4uZgLkw+TbKhRdeq4JHKN/9U9M=\", false, function () {\n  return [useWebSocket];\n});\n\n_c = CoinData;\nexport default CoinData;\n\nvar _c;\n\n$RefreshReg$(_c, \"CoinData\");","map":{"version":3,"sources":["/Users/maxym/Udemy&other/coin-data/client/src/CoinData/CoinData.js"],"names":["Dropdown","Button","useEffect","useState","axios","Highcharts","HighchartsReact","Loader","useWebSocket","moment","Chart","CoinData","data","setData","histPrice","setHistPrice","currentCoin","setCurrentCoin","isLoaded","setIsLoaded","wsMessage","setwsMessage","sendMessage","lastMessage","get","then","response","JSON","parse","console","log","filteredHistData","map","el","Date","time_open","Math","round","rate_open","onSubscribeBtn","alert","stringify","e","value","asset_id","price","unix","time_coinapi","format"],"mappings":"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","sourcesContent":["import './CoinData.css'\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport {Button} from 'react-bootstrap';\nimport {useEffect, useState} from \"react\";\nimport axios from \"axios\";\nimport Highcharts from 'highcharts'\nimport HighchartsReact from 'highcharts-react-official'\nimport \"react-loader-spinner/dist/loader/css/react-spinner-loader.css\";\nimport Loader from \"react-loader-spinner\";\nimport useWebSocket from 'react-use-websocket';\nimport moment from 'moment';\nimport Chart from \"./Chart\";\n\nconst CoinData = () => {\n    const [data, setData] = useState([]);\n    const [histPrice, setHistPrice] = useState([])\n    const [currentCoin, setCurrentCoin] = useState()\n    const [isLoaded, setIsLoaded] = useState(false);\n    const [wsMessage, setwsMessage] = useState([]);\n\n    const {\n        sendMessage,\n        lastMessage,\n    } = useWebSocket('ws://ws.coinapi.io/v1/');\n\n\n    useEffect(() => {\n        axios.get('http://localhost:3008/getAssetId')\n            .then((response) => {\n                setData(response.data)\n            })\n\n    }, [])\n\n    useEffect(() => {\n        if (lastMessage) {\n            setwsMessage(JSON.parse(lastMessage.data))\n            console.log(JSON.parse(lastMessage.data))\n        }\n    }, [lastMessage])\n    let filteredHistData = histPrice.map((el) => [+new Date(el.time_open), Math.round(el.rate_open)]);\n\n\n    const onSubscribeBtn = () => {\n        axios.get(`http://localhost:3008/historicalPrice?coin=${currentCoin}`)\n            .then((response) => {\n                setHistPrice(response.data)\n            })\n        alert(currentCoin)\n        sendMessage(JSON.stringify({\n            \"type\": \"hello\",\n            \"apikey\": \"B7A9ED97-386F-423A-993C-A19DEEC6AB21\",\n            \"heartbeat\": false,\n            \"subscribe_data_type\": [\"trade\"],\n            \"subscribe_filter_symbol_id\": [\n                `BITSTAMP_SPOT_${currentCoin}_USD$`\n            ]\n        }))\n    }\n\n    return (\n        <div className=\"main-container\">\n            <div className=\"select-coin\">\n                <Dropdown className=\"dropdown\" onChange={(e) => {\n                    setCurrentCoin(e.value)\n                }} options={data.map(el => el.asset_id)}\n                          placeholder=\"Select an option\"/>\n                <Button className=\"subscribe-btn\" onClick={onSubscribeBtn} variant=\"primary\">Subscribe</Button>{' '}\n            </div>\n            <p>Market data</p>\n            <div className=\"market-data\">\n                <table width=\"100%\" cellPadding=\"5\">\n                    <tr>\n                        <th>Symbol:</th>\n                        <th>Price:</th>\n                        <th>Time:</th>\n                    </tr>\n                    <tr>\n\n                            <td>{currentCoin}</td>\n                            <td>{\" $ \" + wsMessage.price}</td>\n                            <td>{moment.unix(+new Date(wsMessage.time_coinapi) / 1000).format(\"MMM D, h:mm a\")}</td>\n\n\n                    </tr>\n                </table>\n            </div>\n            <div className=\"charting-data\">\n                <p>Charting data</p>\n                {isLoaded === true\n                    ?\n                    <Loader type=\"TailSpin\" color=\"#0080ff\" height={80} width={80}/>\n                    :\n                    Chart(currentCoin, filteredHistData)\n\n\n                }\n\n\n            </div>\n        </div>\n    )\n}\n\nexport default CoinData;"]},"metadata":{},"sourceType":"module"}
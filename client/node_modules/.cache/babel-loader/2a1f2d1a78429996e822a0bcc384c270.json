{"ast":null,"code":"var _jsxFileName = \"/Users/maxym/Udemy&other/coin-data/client/src/CoinData/CoinData.js\",\n    _s = $RefreshSig$();\n\nimport './CoinData.css';\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { Button } from 'react-bootstrap';\nimport { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport Highcharts from 'highcharts';\nimport HighchartsReact from 'highcharts-react-official';\nimport \"react-loader-spinner/dist/loader/css/react-spinner-loader.css\";\nimport Loader from \"react-loader-spinner\";\nimport useWebSocket from 'react-use-websocket';\nimport moment from 'moment';\nimport Chart from \"./Chart\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst CoinData = () => {\n  _s();\n\n  const [data, setData] = useState([]);\n  const [histPrice, setHistPrice] = useState([]);\n  const [currentCoin, setCurrentCoin] = useState();\n  const [isChartLoading, setChartLoading] = useState(false);\n  const [isWsLoading, setWsLoading] = useState(false);\n  const [wsMessage, setwsMessage] = useState([]);\n  const {\n    sendMessage,\n    lastMessage\n  } = useWebSocket('ws://ws.coinapi.io/v1/');\n  useEffect(() => {\n    axios.get('http://localhost:3008/getAssetId').then(response => {\n      setData(response.data);\n    });\n  }, []);\n  useEffect(() => {\n    if (lastMessage) {\n      setwsMessage(JSON.parse(lastMessage.data));\n      console.log(JSON.parse(lastMessage.data));\n      if (isWsLoading && JSON.parse(lastMessage.data).symbol_id.split('_')[2] == currentCoin) setWsLoading(false);\n    }\n  }, [lastMessage]);\n\n  const onSubscribeBtn = () => {\n    setChartLoading(true);\n    setWsLoading(true);\n    axios.get(`http://localhost:3008/historicalPrice?coin=${currentCoin}`).then(response => {\n      if (response.data) {\n        setHistPrice(response.data.map(el => {\n          const roundedValue = Number(el.rate_open).toFixed(2);\n          return [+new Date(el.time_open), +roundedValue];\n        }));\n        setChartLoading(false);\n      }\n    });\n    sendMessage(JSON.stringify({\n      \"type\": \"hello\",\n      \"apikey\": \"66A15D21-5AB9-41C5-ABA2-43E246120E31\",\n      \"heartbeat\": false,\n      \"subscribe_data_type\": [\"trade\"],\n      \"subscribe_filter_symbol_id\": [`BITSTAMP_SPOT_${currentCoin}_USD$`, `ITBIT_SPOT_${currentCoin}_USD$`, `BINANCE_SPOT_${currentCoin}_USD$`]\n    }));\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"select-coin\",\n      children: [/*#__PURE__*/_jsxDEV(Dropdown, {\n        className: \"dropdown\",\n        onChange: e => {\n          setCurrentCoin(e.value);\n        },\n        options: data.map(el => el.asset_id),\n        placeholder: \"Select a coin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        className: \"subscribe-btn\",\n        onClick: onSubscribeBtn,\n        variant: \"primary\",\n        children: \"Subscribe\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }, this), ' ']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Market data\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"market-data\",\n      children: isWsLoading ? /*#__PURE__*/_jsxDEV(Loader, {\n        type: \"TailSpin\",\n        color: \"#0080ff\",\n        height: 30,\n        width: 30\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 32\n      }, this) : wsMessage.price === undefined ? /*#__PURE__*/_jsxDEV(\"h6\", {\n        children: \"Please select a coin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 53\n      }, this) : /*#__PURE__*/_jsxDEV(\"table\", {\n        width: \"100%\",\n        cellPadding: \"5\",\n        children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Symbol:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Price:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Time:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: currentCoin\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: wsMessage.price === undefined ? /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Please choose a coin\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 37\n            }, this) : \" $ \" + wsMessage.price\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: moment.unix(+new Date(wsMessage.time_coinapi) / 1000).format(\"MMM D, h:mm a\")\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 25\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"charting-data\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Charting data\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this), isChartLoading ? /*#__PURE__*/_jsxDEV(Loader, {\n        type: \"TailSpin\",\n        color: \"#0080ff\",\n        height: 80,\n        width: 80\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 35\n      }, this) : /*#__PURE__*/_jsxDEV(Chart, {\n        currentCoin: currentCoin,\n        filteredHistData: histPrice\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 9\n  }, this);\n};\n\n_s(CoinData, \"yPJLwZF+ogVrr+Zl3gdrpzsfiLU=\", false, function () {\n  return [useWebSocket];\n});\n\n_c = CoinData;\nexport default CoinData;\n\nvar _c;\n\n$RefreshReg$(_c, \"CoinData\");","map":{"version":3,"sources":["/Users/maxym/Udemy&other/coin-data/client/src/CoinData/CoinData.js"],"names":["Dropdown","Button","useEffect","useState","axios","Highcharts","HighchartsReact","Loader","useWebSocket","moment","Chart","CoinData","data","setData","histPrice","setHistPrice","currentCoin","setCurrentCoin","isChartLoading","setChartLoading","isWsLoading","setWsLoading","wsMessage","setwsMessage","sendMessage","lastMessage","get","then","response","JSON","parse","console","log","symbol_id","split","onSubscribeBtn","map","el","roundedValue","Number","rate_open","toFixed","Date","time_open","stringify","e","value","asset_id","price","undefined","unix","time_coinapi","format"],"mappings":"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","sourcesContent":["import './CoinData.css'\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport {Button} from 'react-bootstrap';\nimport {useEffect, useState} from \"react\";\nimport axios from \"axios\";\nimport Highcharts from 'highcharts'\nimport HighchartsReact from 'highcharts-react-official'\nimport \"react-loader-spinner/dist/loader/css/react-spinner-loader.css\";\nimport Loader from \"react-loader-spinner\";\nimport useWebSocket from 'react-use-websocket';\nimport moment from 'moment';\nimport Chart from \"./Chart\";\n\nconst CoinData = () => {\n    const [data, setData] = useState([]);\n    const [histPrice, setHistPrice] = useState([])\n    const [currentCoin, setCurrentCoin] = useState()\n    const [isChartLoading, setChartLoading] = useState(false);\n    const [isWsLoading, setWsLoading] = useState(false);\n    const [wsMessage, setwsMessage] = useState([]);\n\n    const {\n        sendMessage,\n        lastMessage,\n    } = useWebSocket('ws://ws.coinapi.io/v1/');\n\n\n    useEffect(() => {\n        axios.get('http://localhost:3008/getAssetId')\n            .then((response) => {\n                setData(response.data)\n            })\n\n    }, [])\n\n    useEffect(() => {\n        if (lastMessage) {\n            setwsMessage(JSON.parse(lastMessage.data))\n            console.log(JSON.parse(lastMessage.data))\n            if (isWsLoading && JSON.parse(lastMessage.data).symbol_id.split('_')[2] == currentCoin) setWsLoading(false);\n        }\n    }, [lastMessage])\n\n\n    const onSubscribeBtn = () => {\n        setChartLoading(true);\n        setWsLoading(true);\n        axios.get(`http://localhost:3008/historicalPrice?coin=${currentCoin}`)\n            .then((response) => {\n                if (response.data) {\n\n                    setHistPrice(response.data.map((el) => {\n                        const roundedValue = Number(el.rate_open).toFixed(2)\n                        return [+new Date(el.time_open), +roundedValue]\n                    }))\n                    setChartLoading(false)\n                }\n\n            })\n        sendMessage(JSON.stringify({\n            \"type\": \"hello\",\n            \"apikey\": \"66A15D21-5AB9-41C5-ABA2-43E246120E31\",\n            \"heartbeat\": false,\n            \"subscribe_data_type\": [\"trade\"],\n            \"subscribe_filter_symbol_id\": [\n                `BITSTAMP_SPOT_${currentCoin}_USD$`,\n                `ITBIT_SPOT_${currentCoin}_USD$`,\n                `BINANCE_SPOT_${currentCoin}_USD$`\n\n            ]\n        }))\n    }\n\n    return (\n        <div className=\"main-container\">\n            <div className=\"select-coin\">\n                <Dropdown className=\"dropdown\" onChange={(e) => {\n                    setCurrentCoin(e.value)\n                }}\n                          options={data.map(el => el.asset_id)}\n                          placeholder=\"Select a coin\"\n                />\n                <Button className=\"subscribe-btn\" onClick={onSubscribeBtn} variant=\"primary\">Subscribe</Button>{' '}\n            </div>\n            <p>Market data</p>\n            <div className=\"market-data\">\n                {isWsLoading ? <Loader type=\"TailSpin\" color=\"#0080ff\" height={30} width={30}/> :\n                    wsMessage.price === undefined ? <h6>Please select a coin</h6>\n                        :\n                        <table width=\"100%\" cellPadding=\"5\">\n                            <tr>\n                                <th>Symbol:</th>\n                                <th>Price:</th>\n                                <th>Time:</th>\n                            </tr>\n                            <tr>\n\n                                <td>{currentCoin}</td>\n                                <td>{wsMessage.price === undefined ?\n                                    <p>Please choose a coin</p> : \" $ \" + wsMessage.price}</td>\n                                <td>{moment.unix(+new Date(wsMessage.time_coinapi) / 1000).format(\"MMM D, h:mm a\")}</td>\n\n\n                            </tr>\n                        </table>\n                }\n            </div>\n            <div className=\"charting-data\">\n                <p>Charting data</p>\n                {isChartLoading ? <Loader type=\"TailSpin\" color=\"#0080ff\" height={80} width={80}/> :\n                    <Chart\n                        currentCoin={currentCoin}\n                        filteredHistData={histPrice}\n                    />\n                }\n\n\n            </div>\n        </div>\n    )\n}\n\nexport default CoinData;"]},"metadata":{},"sourceType":"module"}